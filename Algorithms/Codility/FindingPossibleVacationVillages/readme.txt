I will be solving this again with unlimited time... I have just a little problem with the function given in the code